
model:
  name: "proto_yolo"
  yolo_weights: "yolov8n.pt"
  num_classes: 5
  proto_feature_dim: 256
  freeze_backbone: false
  use_pretrained: true

few_shot:
  n_way: 5
  k_shot: 5
  query_num: 10
  episodes_per_epoch: 100

training:
  num_epochs: 200
  batch_size: 1
  lr: 0.001
  weight_decay: 0.0001
  optimizer: "adamw"
  scheduler: "cosine"
  warmup_epochs: 5
  gradient_clip: 1.0
  use_amp: true
  early_stopping:
    enabled: true
    patience: 20
    min_delta: 0.001


data:
  data_root: "data/MVTec_AD"
  processed_root: "data/processed"
  train_images: "images/train"
  train_labels: "labels/train"
  val_images:   "images/val"
  val_labels:   "labels/val"
  test_images:  "images/test"
  test_labels:  "labels/test"
  image_size: 640
  augmentation:
    horizontal_flip: 0.5
    vertical_flip: 0.2
    rotate_90: 0.5
    shift_scale_rotate:
      shift_limit: 0.0625
      scale_limit: 0.1
      rotate_limit: 15
      p: 0.5
    brightness_contrast: 0.3
    gauss_noise: 0.2
    blur: 0.1
  normalize:
    mean: [0.485, 0.456, 0.406]
    std:  [0.229, 0.224, 0.225]

validation:
  val_freq: 1
  val_episodes: 50

checkpoint:
  save_dir: "experiments/checkpoints"
  save_freq: 10
  keep_last: 5

logging:
  log_dir: "experiments/logs"
  tensorboard: true

device:
  gpu_ids: [0]
  num_workers: 4
  pin_memory: true
